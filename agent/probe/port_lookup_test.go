package probe

import (
	"strings"
	"testing"
)

func TestLookupAppMap(t *testing.T) {
	names := map[uint32]string{
		2016: "java",
		2007: "java",
		2003: "java",
		2004: "java",
	}

	apps := map[uint32][]string{
		2016: []string{"/usr/bin/java", "-Xmx2048m", "-server", "-Djava.awt.headless=true", "-Djavax.security.auth.useSubjectCredsOnly=false", "-Dsun.net.inetaddr.ttl=300", "-Dsun.net.inetaddr.negative.ttl=3600", "-XX:+HeapDumpOnOutOfMemoryError", "-XX:HeapDumpPath=/tmp", "-XX:+UseParNewGC", "-XX:+UseConcMarkSweepGC", "-XX:+CMSParallelRemarkEnabled", "-XX:+UseTLAB", "-XX:CMSInitiatingOccupancyFraction=75", "-XX:+UseCMSInitiatingOccupancyOnly", "-XX:+UseCondCardMark", "-Dsun.rmi.dgc.server.gcInterval=9223372036854775807", "-Dsun.rmi.dgc.client.gcInterval=9223372036854775807", "-XX:CMSWaitDuration=120000", "-XX:CMSMaxAbortablePrecleanTime=120000", "-XX:+ExplicitGCInvokesConcurrent", "-XX:+CMSScavengeBeforeRemark", "-XX:+CMSClassUnloadingEnabled", "-Dlog4j.configuration=file:///opt/voltdb/voltdb/log4j.xml", "-Djava.library.path=default", "-classpath", "/opt/voltdb/voltdb/voltdb-6.6.jar:/opt/voltdb/lib/avro-1.7.7.jar:/opt/voltdb/lib/commons-logging-1.1.3.jar:/opt/voltdb/lib/jetty-continuation-9.3.6.v20151106.jar:/opt/voltdb/lib/snappy-java-1.1.1.7.jar:/opt/voltdb/lib/owner-1.0.9.jar:/opt/voltdb/lib/jetty-server-9.3.6.v20151106.jar:/opt/voltdb/lib/groovy-all-2.1.7-indy.jar:/opt/voltdb/lib/servlet-api-3.1.jar:/opt/voltdb/lib/jetty-http-9.3.6.v20151106.jar:/opt/voltdb/lib/jetty-io-9.3.6.v20151106.jar:/opt/voltdb/lib/httpasyncclient-4.0.1.jar:/opt/voltdb/lib/kafka_2.10-0.8.2.1.jar:/opt/voltdb/lib/jna.jar:/opt/voltdb/lib/log4j-1.2.16.jar:/opt/voltdb/lib/httpclient-4.3.2.jar:/opt/voltdb/lib/owner-java8-1.0.9.jar:/opt/voltdb/lib/jsch-0.1.51.jar:/opt/voltdb/lib/protobuf-java-2.5.0.jar:/opt/voltdb/lib/jackson-mapper-asl-1.9.13.jar:/opt/voltdb/lib/lz4-1.2.0.jar:/opt/voltdb/lib/kafka-clients-0.8.2.1.jar:/opt/voltdb/lib/tomcat-jdbc.jar:/opt/voltdb/lib/metrics-core-2.2.0.jar:/opt/voltdb/lib/slf4j-api-1.6.2.jar:/opt/voltdb/lib/slf4j-nop-1.6.2.jar:/opt/voltdb/lib/jline-2.10.jar:/opt/voltdb/lib/commons-lang3-3.0.jar:/opt/voltdb/lib/tomcat-juli.jar:/opt/voltdb/lib/commons-codec-1.6.jar:/opt/voltdb/lib/jetty-util-9.3.6.v20151106.jar:/opt/voltdb/lib/scala-library-2.10.4.jar:/opt/voltdb/lib/httpcore-nio-4.3.2.jar:/opt/voltdb/lib/httpcore-4.3.2.jar:/opt/voltdb/lib/jackson-core-asl-1.9.13.jar:/opt/voltdb/lib/felix.jar:/opt/voltdb/lib/super-csv-2.1.0.jar", "org.voltdb.VoltDB", "probe", "placementgroup", "0", "voltdbroot", "/var/voltdb/", "mesh", "", "hostcount", "1"},
		2007: []string{"/opt/jdk/bin/java", "-Xmx1G", "-Xms1G", "-server", "-XX:+UseG1GC", "-XX:MaxGCPauseMillis=20", "-XX:InitiatingHeapOccupancyPercent=35", "-XX:+DisableExplicitGC", "-Djava.awt.headless=true", "-Xloggc:/opt/kafka_2.11-0.10.1.0/bin/../logs/kafkaServer-gc.log", "-verbose:gc", "-XX:+PrintGCDetails", "-XX:+PrintGCDateStamps", "-XX:+PrintGCTimeStamps", "-Dcom.sun.management.jmxremote", "-Dcom.sun.management.jmxremote.authenticate=false", "-Dcom.sun.management.jmxremote.ssl=false", "-Dkafka.logs.dir=/opt/kafka_2.11-0.10.1.0/bin/../logs", "-Dlog4j.configuration=file:/opt/kafka_2.11-0.10.1.0/bin/../config/log4j.properties", "-cp", ":/opt/kafka_2.11-0.10.1.0/bin/../libs/aopalliance-repackaged-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/argparse4j-0.5.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-api-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-file-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-json-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-runtime-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/guava-18.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/hk2-api-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/hk2-locator-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/hk2-utils-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-annotations-2.6.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-core-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-databind-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-jaxrs-base-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-jaxrs-json-provider-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-module-jaxb-annotations-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javassist-3.18.2-GA.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.annotation-api-1.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.inject-1.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.inject-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.servlet-api-3.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.ws.rs-api-2.0.1.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-client-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-common-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-container-servlet-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-container-servlet-core-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-guava-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-media-jaxb-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-server-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-continuation-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-http-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-io-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-security-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-server-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-servlet-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-servlets-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-util-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jopt-simple-4.9.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-clients-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-log4j-appender-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-streams-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-streams-examples-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-tools-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka_2.11-0.10.1.0-sources.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka_2.11-0.10.1.0-test-sources.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka_2.11-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/log4j-1.2.17.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/lz4-1.3.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/metrics-core-2.2.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/osgi-resource-locator-1.0.1.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/reflections-0.9.10.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/rocksdbjni-4.9.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/scala-library-2.11.8.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/scala-parser-combinators_2.11-1.0.4.jar"},
		//2007: []string{"/opt/jdk/bin/java", "-Xmx1G", "-Xms1G", "-server", "-XX:+UseG1GC", "-XX:MaxGCPauseMillis=20", "-XX:InitiatingHeapOccupancyPercent=35", "-XX:+DisableExplicitGC", "-Djava.awt.headless=true", "-Xloggc:/opt/kafka_2.11-0.10.1.0/bin/../logs/kafkaServer-gc.log", "-verbose:gc", "-XX:+PrintGCDetails", "-XX:+PrintGCDateStamps", "-XX:+PrintGCTimeStamps", "-Dcom.sun.management.jmxremote", "-Dcom.sun.management.jmxremote.authenticate=false", "-Dcom.sun.management.jmxremote.ssl=false", "-Dkafka.logs.dir=/opt/kafka_2.11-0.10.1.0/bin/../logs", "-Dlog4j.configuration=file:/opt/kafka_2.11-0.10.1.0/bin/../config/log4j.properties", "-cp", ":/opt/kafka_2.11-0.10.1.0/bin/../libs/aopalliance-repackaged-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/argparse4j-0.5.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-api-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-file-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-json-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/connect-runtime-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/guava-18.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/hk2-api-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/hk2-locator-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/hk2-utils-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-annotations-2.6.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-core-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-databind-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-jaxrs-base-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-jaxrs-json-provider-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jackson-module-jaxb-annotations-2.6.3.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javassist-3.18.2-GA.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.annotation-api-1.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.inject-1.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.inject-2.4.0-b34.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.servlet-api-3.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/javax.ws.rs-api-2.0.1.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-client-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-common-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-container-servlet-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-container-servlet-core-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-guava-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-media-jaxb-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jersey-server-2.22.2.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-continuation-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-http-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-io-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-security-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-server-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-servlet-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-servlets-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jetty-util-9.2.15.v20160210.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/jopt-simple-4.9.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-clients-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-log4j-appender-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-streams-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-streams-examples-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka-tools-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka_2.11-0.10.1.0-sources.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka_2.11-0.10.1.0-test-sources.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/kafka_2.11-0.10.1.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/log4j-1.2.17.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/lz4-1.3.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/metrics-core-2.2.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/osgi-resource-locator-1.0.1.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/reflections-0.9.10.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/rocksdbjni-4.9.0.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/scala-library-2.11.8.jar:/opt/kafka_2.11-0.10.1.0/bin/../libs/scala-parser-combinators_2.11-1.0.4.jar", "kafka.Kafka", "/opt/kafka/config/server.properties"},
		2003: []string{"/usr/lib/jvm/java-7-openjdk-amd64/bin/java", "-Dzookeeper.log.dir=.", "-Dzookeeper.root.logger=INFO,CONSOLE", "-cp", "/opt/zookeeper-3.4.6/bin/../build/classes:/opt/zookeeper-3.4.6/bin/../build/lib/*.jar:/opt/zookeeper-3.4.6/bin/../lib/slf4j-log4j12-1.6.1.jar:/opt/zookeeper-3.4.6/bin/../lib/slf4j-api-1.6.1.jar:/opt/zookeeper-3.4.6/bin/../lib/netty-3.7.0.Final.jar:/opt/zookeeper-3.4.6/bin/../lib/log4j-1.2.16.jar:/opt/zookeeper-3.4.6/bin/../lib/jline-0.9.94.jar:/opt/zookeeper-3.4.6/bin/../zookeeper-3.4.6.jar:/opt/zookeeper-3.4.6/bin/../src/java/lib/*.jar:/opt/zookeeper-3.4.6/bin/../conf:", "-Dcom.sun.management.jmxremote", "-Dcom.sun.management.jmxremote.local.only=false", "org.apache.zookeeper.server.quorum.QuorumPeerMain", "/opt/zookeeper-3.4.6/bin/../conf/zoo.cfg"},
		2004: strings.Fields("/opt/java/openjdk/bin/java -ea -da:net.openhft... -XX:+UseThreadPriorities -XX:+HeapDumpOnOutOfMemoryError -Xss256k -XX:+AlwaysPreTouch -XX:-UseBiasedLocking -XX:+UseTLAB -XX:+ResizeTLAB -XX:+UseNUMA -XX:+PerfDisableSharedMem -Djava.net.preferIPv4Stack=true -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:SurvivorRatio=8 -XX:MaxTenuringThreshold=1 -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSWaitDuration=10000 -XX:+CMSParallelInitialMarkEnabled -XX:+CMSEdenChunksRecordAlways -XX:+CMSClassUnloadingEnabled -Djdk.attach.allowAttachSelf=true --add-exports java.base/jdk.internal.misc=ALL-UNNAMED --add-exports java.base/jdk.internal.ref=ALL-UNNAMED --add-exports java.base/sun.nio.ch=ALL-UNNAMED --add-exports java.management.rmi/com.sun.jmx.remote.internal.rmi=ALL-UNNAMED --add-exports java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports java.rmi/sun.rmi.server=ALL-UNNAMED --add-exports java.sql/java.sql=ALL-UNNAMED --add-opens java.base/java.lang.module=ALL-UNNAMED --add-opens java.base/jdk.internal.loader=ALL-UNNAMED --add-opens java.base/jdk.internal.ref=ALL-UNNAMED --add-opens java.base/jdk.internal.reflect=ALL-UNNAMED --add-opens java.base/jdk.internal.math=ALL-UNNAMED --add-opens java.base/jdk.internal.module=ALL-UNNAMED --add-opens java.base/jdk.internal.util.jar=ALL-UNNAMED --add-opens jdk.management/com.sun.management.internal=ALL-UNNAMED -Dio.netty.tryReflectionSetAccessible=true -Xlog:gc=info,heap*=trace,age*=debug,safepoint=info,promotion*=trace:file=/opt/cassandra/logs/gc.log:time,uptime,pid,tid,level:filecount=10,filesize=10485760 -Xms1024M -Xmx1024M -Xmn100M -XX:+UseCondCardMark -XX:CompileCommandFile=/etc/cassandra/hotspot_compiler -javaagent:/opt/cassandra/lib/jamm-0.3.2.jar -Dcassandra.jmx.local.port=7199 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.password.file=/etc/cassandra/jmxremote.password -Djava.library.path=/opt/cassandra/lib/sigar-bin -Dcassandra.libjemalloc=/usr/local/lib/libjemalloc.so -XX:OnOutOfMemoryError=kill -9 %p -Dlogback.configurationFile=logback.xml -Dcassandra.logdir=/opt/cassandra/logs -Dcassandra.storagedir=/opt/cassandra/data -Dcassandra-foreground=yes -cp /etc/cassandra:/opt/cassandra/lib/HdrHistogram-2.1.9.jar:/opt/cassandra/lib/ST4-4.0.8.jar:/opt/cassandra/lib/airline-0.8.jar:/opt/cassandra/lib/antlr-runtime-3.5.2.jar:/opt/cassandra/lib/apache-cassandra-4.0.1.jar:/opt/cassandra/lib/asm-7.1.jar:/opt/cassandra/lib/caffeine-2.3.5.jar:/opt/cassandra/lib/cassandra-driver-core-3.11.0-shaded.jar:/opt/cassandra/lib/chronicle-bytes-2.20.111.jar:/opt/cassandra/lib/chronicle-core-2.20.126.jar:/opt/cassandra/lib/chronicle-queue-5.20.123.jar:/opt/cassandra/lib/chronicle-threads-2.20.111.jar:/opt/cassandra/lib/chronicle-wire-2.20.117.jar:/opt/cassandra/lib/commons-cli-1.1.jar:/opt/cassandra/lib/commons-codec-1.9.jar:/opt/cassandra/lib/commons-lang3-3.11.jar:/opt/cassandra/lib/commons-math3-3.2.jar:/opt/cassandra/lib/concurrent-trees-2.4.0.jar:/opt/cassandra/lib/ecj-4.6.1.jar:/opt/cassandra/lib/guava-27.0-jre.jar:/opt/cassandra/lib/high-scale-lib-1.0.6.jar:/opt/cassandra/lib/hppc-0.8.1.jar:/opt/cassandra/lib/j2objc-annotations-1.3.jar:/opt/cassandra/lib/jackson-annotations-2.9.10.jar:/opt/cassandra/lib/jackson-core-2.9.10.jar:/opt/cassandra/lib/jackson-databind-2.9.10.8.jar:/opt/cassandra/lib/jamm-0.3.2.jar:/opt/cassandra/lib/java-cup-runtime-11b-20160615.jar:/opt/cassandra/lib/javax.inject-1.jar:/opt/cassandra/lib/jbcrypt-0.3m.jar:/opt/cassandra/lib/jcl-over-slf4j-1.7.25.jar:/opt/cassandra/lib/jcommander-1.30.jar:/opt/cassandra/lib/jctools-core-3.1.0.jar:/opt/cassandra/lib/jflex-1.8.2.jar:/opt/cassandra/lib/jna-5.6.0.jar:/opt/cassandra/lib/json-simple-1.1.jar:/opt/cassandra/lib/jvm-attach-api-1.5.jar:/opt/cassandra/lib/log4j-over-slf4j-1.7.25.jar:/opt/cassandra/lib/logback-classic-1.2.3.jar:/opt/cassandra/lib/logback-core-1.2.3.jar:/opt/cassandra/lib/lz4-java-1.8.0.jar:/opt/cassandra/lib/metrics-core-3.1.5.jar:/opt/cassandra/lib/metrics-jvm-3.1.5.jar:/opt/cassandra/lib/metrics-logback-3.1.5.jar:/opt/cassandra/lib/mxdump-0.14.jar:/opt/cassandra/lib/netty-all-4.1.58.Final.jar:/opt/cassandra/lib/netty-tcnative-boringssl-static-2.0.36.Final.jar:/opt/cassandra/lib/ohc-core-0.5.1.jar:/opt/cassandra/lib/ohc-core-j8-0.5.1.jar:/opt/cassandra/lib/psjava-0.1.19.jar:/opt/cassandra/lib/reporter-config-base-3.0.3.jar:/opt/cassandra/lib/reporter-config3-3.0.3.jar:/opt/cassandra/lib/sigar-1.6.4.jar:/opt/cassandra/lib/sjk-cli-0.14.jar:/opt/cassandra/lib/sjk-core-0.14.jar:/opt/cassandra/lib/sjk-json-0.14.jar:/opt/cassandra/lib/sjk-stacktrace-0.14.jar:/opt/cassandra/lib/slf4j-api-1.7.25.jar:/opt/cassandra/lib/snakeyaml-1.26.jar:/opt/cassandra/lib/snappy-java-1.1.2.6.jar:/opt/cassandra/lib/snowball-stemmer-1.3.0.581.1.jar:/opt/cassandra/lib/stream-2.5.2.jar:/opt/cassandra/lib/zstd-jni-1.5.0-4.jar:/opt/cassandra/lib/jsr223/*/*.jar: org.apache.cassandra.service.CassandraDaemon "),
	}

	for k, v := range apps {
		name, _ := names[k]
		out, res := lookupAppMap(name, v)
		if k != out || !res {
			t.Errorf("Error: %v\n", k)
			t.Errorf("  Expect: %v\n", v)
			t.Errorf("  Actual: %v\n", out)
		}
	}
}
